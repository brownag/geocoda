% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diagnostics_assessment.R
\name{gc_assess_gaussianity}
\alias{gc_assess_gaussianity}
\title{Assess Gaussianity of ILR Values}
\usage{
gc_assess_gaussianity(
  ilr_values,
  method = "anderson",
  plot = TRUE,
  alpha = 0.05
)
}
\arguments{
\item{ilr_values}{A matrix or data frame with ILR values (each column is one dimension).}

\item{method}{Character string specifying normality test: \code{"anderson"} (default)
uses Anderson-Darling test; \code{"shapiro"} uses Shapiro-Wilk (univariate only);
\code{"mardia"} uses Mardia's multivariate skewness/kurtosis.}

\item{plot}{Logical. If \code{TRUE} (default), display Q-Q plots and histograms.}

\item{alpha}{Significance level for normality test (default 0.05).}
}
\value{
A list containing:
\itemize{
\item \code{gaussian}: Logical indicating whether multivariate normality is supported
\item \code{method_used}: Character string indicating which test was used
\item \code{p_values}: P-values from normality tests for each dimension (Anderson) or multivariate (Mardia)
\item \code{skewness}: Multivariate skewness (if method = "mardia")
\item \code{kurtosis}: Multivariate excess kurtosis (if method = "mardia")
\item \code{recommendation}: Character string with interpretation and suggested remedies
\item \code{summary}: Data frame with dimension-wise test statistics
}
}
\description{
Test whether the ILR-transformed compositional data follow a multivariate normal
distribution. Sequential Gaussian Simulation assumes normality; departures from
normality (e.g., bimodal or skewed distributions) may compromise simulation accuracy.
}
\details{
\strong{Anderson-Darling Test} (univariate, recommended for 2-3D):
Tests each ILR dimension separately against normality. More sensitive to tail
deviations than Shapiro-Wilk. Dimensions failing the test indicate non-Gaussianity
in that specific balance (e.g., a bimodal distribution in sand vs silt balance).

\strong{Shapiro-Wilk Test} (univariate):
Limited to D â‰¤ 5000 samples. Less sensitive to tail behavior than Anderson-Darling.

\strong{Mardia's Test} (multivariate):
Tests for joint departures from normality via multivariate skewness and kurtosis.
More holistic but less specific about which dimensions violate normality.

\strong{Interpretation and Remedies}:
\itemize{
\item Gaussian: Proceed with Sequential Gaussian Simulation (SGS)
\item Non-Gaussian: Consider:
\enumerate{
\item \strong{Anamorphosis}: Apply normal-score transform before simulation, back-transform after
\item \strong{Domain stratification}: Bimodal distributions suggest distinct geological units
\item \strong{t-location-scale model}: Alternative to Gaussian for heavier tails
\item Accept and document uncertainty: Some non-Gaussianity is common in real soil data
}
}
}
\examples{
\dontrun{
# Test ILR values
samples <- data.frame(
  sand = c(20, 25, 30, 22, 18, 35),
  silt = c(60, 55, 50, 58, 62, 45),
  clay = c(20, 20, 20, 20, 20, 20)
)

ilr_vals <- compositions::ilr(compositions::acomp(samples))
colnames(ilr_vals) <- c("ilr1", "ilr2")

# Assess Gaussianity
gaussianity <- gc_assess_gaussianity(ilr_vals, method = "anderson", plot = TRUE)
print(gaussianity$recommendation)
}

}
