% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diagnostics_assessment.R
\name{gc_assess_stationarity}
\alias{gc_assess_stationarity}
\title{Assess Stationarity of Compositional Spatial Data}
\usage{
gc_assess_stationarity(
  data,
  method = "biplot",
  plot = TRUE,
  window_size = NULL
)
}
\arguments{
\item{data}{A data frame or sf object with columns \code{x}, \code{y} for spatial coordinates
and columns \code{ilr1}, \code{ilr2}, etc., with ILR values.}

\item{method}{Character string specifying diagnostic approach: \code{"biplot"} (default)
uses PCA and spatial coloring; \code{"local"} computes local covariance within
spatial windows.}

\item{plot}{Logical. If \code{TRUE} (default), display biplot colored by spatial location
to visually inspect for clusters or gradients.}

\item{window_size}{Numeric. Size of local window for \code{method = "local"} (default \code{NULL}
uses automatic sizing based on spatial extent).}
}
\value{
A list containing:
\itemize{
\item \code{stationary}: Logical indicating whether global stationarity assumption is supported
\item \code{method_used}: Character string indicating which diagnostic was used
\item \code{pca_loadings}: PCA loadings matrix (for biplot method)
\item \code{pca_scores}: Principal component scores
\item \code{spatial_variance}: Estimated variance of spatial means across local windows
\item \code{recommendation}: Character string with interpretation and recommended action
\item \code{summary}: Data frame with diagnostic statistics
}
}
\description{
Evaluate whether the spatial correlation structure is constant (stationary) across
the study area using PCA biplot visualization and spatial clustering diagnostics.
Non-stationarity suggests the domain should be stratified or that a global Linear
Model of Coregionalization may be inappropriate.
}
\details{
\strong{Biplot Method} (default):
Performs PCA on ILR values and creates a biplot with points colored by spatial
location (x, y). If the biplot shows distinct clusters that spatially correspond
to different regions of the study area, this suggests non-stationarity (e.g.,
distinct geological units with different covariance structures).

\strong{Local Method}:
Divides the spatial domain into regular windows and computes covariance separately
in each window. Large variation in covariance between windows indicates non-stationarity.

\strong{Interpretation}:
\itemize{
\item Stationary: Points are randomly scattered in biplot, no spatial clustering
\item Non-Stationary: Distinct biplot clusters correspond to distinct spatial regions
\item Action: If non-stationary, stratify the domain and apply the kriging workflow
independently to each stratum.
}
}
\examples{
\dontrun{
# Create sample data with spatial coordinates and ILR values
n_points <- 100
set.seed(42)
data <- data.frame(
  x = runif(n_points, 0, 100),
  y = runif(n_points, 0, 100),
  ilr1 = rnorm(n_points, mean = 0.5, sd = 0.8),
  ilr2 = rnorm(n_points, mean = -0.2, sd = 0.6)
)

# Assess stationarity
stationarity <- gc_assess_stationarity(data, method = "biplot", plot = TRUE)
print(stationarity$recommendation)

# Or use local window method
stationarity_local <- gc_assess_stationarity(data, method = "local")
print(stationarity_local$summary)
}

}
