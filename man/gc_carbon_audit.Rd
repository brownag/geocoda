% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/risk_assessment.R
\name{gc_carbon_audit}
\alias{gc_carbon_audit}
\title{Specialized Carbon Stock Audit Function}
\usage{
gc_carbon_audit(
  simulations,
  credit_threshold,
  confidence = 0.9,
  component = NULL,
  audit_type = "conservative",
  na.rm = TRUE
)
}
\arguments{
\item{simulations}{A \code{terra::SpatRaster} stack or data.frame with simulation
realizations. If raster, returns spatial results; if data.frame, returns
tabular summary (useful for non-spatial audits).}

\item{credit_threshold}{Numeric. Minimum carbon stock (Mg/ha or equivalent units)
required for credit issuance.}

\item{confidence}{Numeric in (0, 1). Confidence level for conservative estimates.
\itemize{
\item confidence = 0.9: Use P10 (10th percentile, 90\% sure actual ≥ this value)
\item confidence = 0.95: Use P5 (5th percentile, 95\% sure actual ≥ this value)
\item Default: 0.9
}}

\item{component}{Character. If multi-component simulations, which variable
represents carbon stock (e.g., "SOC"). Usually not needed for single-variable
simulations.}

\item{audit_type}{Character. Verification strategy:
\itemize{
\item \code{"conservative"} (default): Issue credits only if P(1-confidence) > threshold
(suitable for credit issuance with low risk)
\item \code{"expected"}: Use P50 (median estimate, medium risk)
\item \code{"optimistic"}: Use P(confidence) (exploratory/planning, high risk)
}}

\item{na.rm}{Logical. Exclude NA values from calculations.}
}
\value{
List containing:
\itemize{
\item \code{probability_map} (if raster input): SpatRaster of P(SOC > threshold)
\item \code{conservative_estimate} (if raster input): SpatRaster of percentile values
\item \code{issued_credit} (if raster input): SpatRaster with 0/1 credit approval
\item \code{summary}: Data.frame with aggregate statistics (total area, eligible area,
total credits issuable, etc.)
\item \code{audit_report}: Character string with human-readable audit summary
\item \code{metadata}: List with audit parameters and timestamp
}
}
\description{
Comprehensive wrapper for carbon credit verification in payment-for-ecosystem-services
programs. Computes conservative estimates, probability maps, and audit reports.
}
\details{
\strong{Carbon Audit Methodology:}
\enumerate{
\item Compute conservative percentile map (e.g., P10 for 90\% confidence)
\item Compute probability of exceeding credit threshold
\item Determine eligible area where conservative_estimate > credit_threshold
\item Aggregate results and generate audit report
}

\strong{Interpretation of Audit Report:}
\itemize{
\item \strong{Total Area}: Entire audit domain
\item \strong{Eligible Area}: Where conservative estimate exceeds threshold
\item \strong{Total Credits}: Eligible area × mean conservative estimate
\item \strong{Confidence Level}: Trust level in issued credits
}
}
\examples{
\dontshow{if (Sys.getenv("R_GEOCODA_RUN_EXAMPLES") == "true") withAutoprint(\{ # examplesIf}
# Create synthetic data
set.seed(42)
carbon_sims <- terra::rast(ncol = 10, nrow = 10, nlyr = 100)
terra::values(carbon_sims) <- rnorm(10000, mean = 55, sd = 15)

# Standard 90\% confidence audit for carbon credit program
audit <- gc_carbon_audit(
  simulations = carbon_sims,
  credit_threshold = 50,
  confidence = 0.9,
  audit_type = "conservative"
)

# Print human-readable report
cat(audit$audit_report)

# Check eligible area
eligible_pixels <- sum(terra::values(audit$issued_credit) == 1, na.rm = TRUE)
total_pixels <- terra::ncell(audit$issued_credit)
cat("Eligible area:", eligible_pixels, "/", total_pixels, "pixels\n")

# Map results
terra::plot(audit$probability_map, main = "P(SOC > 50 Mg/ha)")
terra::plot(audit$issued_credit, main = "Credit Approved (Green) vs Denied (Red)")
\dontshow{\}) # examplesIf}
}
