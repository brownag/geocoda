% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hierarchical_zones.R
\name{gc_fit_hierarchical_model}
\alias{gc_fit_hierarchical_model}
\title{Fit Hierarchical Shrinkage Model to Zone Data}
\usage{
gc_fit_hierarchical_model(
  data,
  prior_spec,
  n_iter = 2000,
  n_burnin = 500,
  n_chains = 2,
  adapt_delta = 0.8,
  verbose = TRUE
)
}
\arguments{
\item{data}{Data frame with columns: zone (factor), ilr1, ilr2, ... (ILR values)}

\item{prior_spec}{An object of class \code{"gc_prior_spec"} (from \code{gc_set_hierarchy_priors()})}

\item{n_iter}{DEPRECATED. Reserved for future MCMC implementation (v0.3.0).
Currently ignored. Do not use.}

\item{n_burnin}{DEPRECATED. Reserved for future MCMC implementation (v0.3.0).
Currently ignored. Do not use.}

\item{n_chains}{DEPRECATED. Reserved for future MCMC implementation (v0.3.0).
Currently ignored. Do not use.}

\item{adapt_delta}{DEPRECATED. Reserved for future MCMC implementation (v0.3.0).
Currently ignored. Do not use.}

\item{verbose}{Logical, print estimation progress (default TRUE)}
}
\value{
An S3 object of class \code{"gc_hierarchical_fit"} containing:
\itemize{
\item \code{zone_estimates}: Zone-specific parameter estimates (mean, covariance)
\item \code{global_estimates}: Global parameter estimates (mean, covariance)
\item \code{shrinkage_weights}: Pooling weights applied to each zone
\item \code{zone_summaries}: Data frame with posterior means, SDs, CIs per zone
\item \code{prior_spec}: Original prior specification
\item \code{metadata}: Fitting information including method and timestamp
}
}
\description{
Estimate zone-specific parameters using empirical Bayes shrinkage toward
a global mean. Zone estimates are pooled via weighted averaging, with the
strength of pooling controlled by \code{pooling_coefficient} in \code{gc_set_hierarchy_priors()}.
This method provides fast analytical estimates suitable for exploration,
visualization, and initial inference.
}
\details{
\strong{NOTE}: This is empirical Bayes shrinkage, NOT full Bayesian MCMC inference.
True Bayesian MCMC with posterior sampling is planned for geocoda v0.3.0.

The shrinkage estimation method:
\enumerate{
\item Computes zone-specific maximum likelihood estimates (MLE)
\item Pools zone estimates toward global mean via weighted average
\item Shrinkage strength controlled by \code{pooling_coefficient} from priors
\item Analytical solution with no MCMC sampling
}

Shrinkage formula:

\if{html}{\out{<div class="sourceCode">}}\preformatted{mu[zone] = (1 - lambda) * mu_zone_MLE + lambda * mu_global
Sigma[zone] = [1 / (1 + n_zone * lambda)] * Sigma_zone_MLE
}\if{html}{\out{</div>}}

where \code{lambda = pooling_coefficient} from \code{gc_set_hierarchy_priors()}:
\itemize{
\item lambda = 0.0: No pooling (zone-specific only)
\item lambda = 0.05: Weak pooling
\item lambda = 0.2: Moderate pooling
\item lambda = 0.5: Strong pooling toward global
}

This is suitable for quick exploration and visualization. For publication-quality
Bayesian inference with full posterior distributions, use true MCMC (planned for v0.3.0).
}
\examples{
\dontrun{
hierarchy <- gc_define_hierarchy(
  zone_names = c("Zone1", "Zone2", "Zone3"),
  component_names = c("sand", "silt", "clay")
)
priors <- gc_set_hierarchy_priors(hierarchy, pooling = "moderate")
data_zones <- data.frame(
  zone = rep(c("Zone1", "Zone2", "Zone3"), each = 5),
  ilr1 = rnorm(15), ilr2 = rnorm(15)
)
# Estimate with shrinkage
fit <- gc_fit_hierarchical_model(data_zones, priors)
print(fit)
}

}
