% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_sources.R
\name{gc_horizon_stratify}
\alias{gc_horizon_stratify}
\title{Stratify Compositional Parameters by Soil Horizon Depth}
\usage{
gc_horizon_stratify(
  x,
  comp_cols = c("sandtotal", "silttotal", "claytotal"),
  horizon_breaks = c(0, 30, 60, 100),
  horizon_labels = NULL,
  agg_method = "weighted"
)
}
\arguments{
\item{x}{Data frame with soil composition by horizon. Must contain:
\itemize{
\item Compositional columns (e.g., sand, silt, clay)
\item \code{hzdept_r} (numeric): depth to top of horizon (cm)
\item \code{hzdepb_r} (numeric): depth to bottom of horizon (cm)
}}

\item{comp_cols}{Character vector, names of compositional columns
(default: c("sandtotal", "silttotal", "claytotal"))}

\item{horizon_breaks}{Numeric vector of depth breakpoints (cm) to define strata
(default: c(0, 30, 60, 100) for surface, subsurface-1, subsurface-2, deep)}

\item{horizon_labels}{Character vector, names for strata
(default: c("surface", "subsurface_1", "subsurface_2", "deep"))}

\item{agg_method}{Character, aggregation method:
\itemize{
\item "weighted" (default): weight by horizon thickness
\item "mean": simple mean
\item "median": median values
}}
}
\value{
List with one element per stratum. Each contains:
\itemize{
\item \code{constraints}: Constraint list (min, representative, max)
\item \code{samples}: Component samples from that stratum
\item \code{depth_range}: Depth bounds (cm) for the stratum
\item \code{n_samples}: Number of samples in stratum
}
}
\description{
Create depth-stratified constraint and sample sets from soil composition data
with multiple horizons. Enables depth-specific simulation workflows.
}
\details{
Horizons spanning multiple depth strata are split proportionally. For example,
a horizon from 20-50 cm split between surface (0-30) and subsurface_1 (30-60)
would include:
\itemize{
\item 10 cm (20-30) in surface stratum
\item 20 cm (30-50) in subsurface_1 stratum
}
}
\examples{
# Composition data with multiple horizons
horizon_data <- data.frame(
  sandtotal = c(35, 30, 25),
  silttotal = c(50, 55, 60),
  claytotal = c(15, 15, 15),
  hzdept_r = c(0, 25, 60),
  hzdepb_r = c(25, 60, 100)
)

strata <- gc_horizon_stratify(
  horizon_data,
  horizon_breaks = c(0, 30, 60, 100)
)

# Use surface stratum for shallow simulation
surface_params <- strata$surface

}
