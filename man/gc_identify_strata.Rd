% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/domain_stratification.R
\name{gc_identify_strata}
\alias{gc_identify_strata}
\title{Identify Spatial Strata from PCA Clustering}
\usage{
gc_identify_strata(data, n_strata = 2, method = "kmeans", plot = TRUE)
}
\arguments{
\item{data}{A data frame or sf object with columns \code{x}, \code{y} for spatial coordinates
and columns \code{ilr1}, \code{ilr2}, etc., with ILR values.}

\item{n_strata}{Numeric. Number of strata to identify (default 2). Can be a vector
of candidate values for automatic selection via silhouette analysis.}

\item{method}{Character string specifying clustering approach: \code{"kmeans"} (default)
uses K-means clustering; \code{"hierarchical"} uses hierarchical clustering with
automatic cut height detection.}

\item{plot}{Logical. If \code{TRUE} (default), visualize strata spatially and via PCA.}
}
\value{
A list containing:
\itemize{
\item \code{strata}: Factor vector indicating stratum membership for each observation
\item \code{n_strata}: Number of identified strata
\item \code{cluster_centers}: Cluster centers in PCA space
\item \code{silhouette_widths}: Silhouette widths for each observation (quality of assignment)
\item \code{recommendation}: Character string with interpretation and suggested actions
\item \code{summary}: Data frame with stratum-wise statistics
}
}
\description{
Automatically detect spatial domains or strata based on clustering of Principal
Component scores from ILR values. This suggests natural compositional boundaries
within the study area, useful for domain stratification when non-stationarity is detected.
}
\details{
\strong{Methodology}:
\enumerate{
\item Perform PCA on ILR values
\item Apply K-means clustering on PC1-PC2 scores
\item Assign each spatial location to a cluster/stratum
\item Optionally optimize cluster count via silhouette analysis
}

\strong{Interpretation}:
\itemize{
\item Silhouette width: -1 (worst assignment) to +1 (best assignment)
\item Mean silhouette > 0.5 indicates strong clustering
\item Strata with low silhouette widths may need adjustment (merge or increase n_strata)
}

\strong{Usage in Workflow}:
After detecting non-stationarity via \code{gc_assess_stationarity()}, use this function
to suggest how to partition the domain. Then apply the modeling workflow independently
to each stratum for improved modeling.
}
\examples{
\dontrun{
# Create sample data with distinct compositional domains
n_points <- 100
set.seed(42)
data <- data.frame(
  x = runif(n_points, 0, 100),
  y = runif(n_points, 0, 100),
  ilr1 = c(rnorm(50, 0.3, 0.6), rnorm(50, -0.3, 0.6)),
  ilr2 = c(rnorm(50, 0.1, 0.5), rnorm(50, 0.2, 0.5))
)

# Identify spatial strata
strata_result <- gc_identify_strata(data, n_strata = 2, plot = TRUE)
print(strata_result$recommendation)
print(strata_result$summary)

# Use stratum information for domain-specific modeling
stratum_1 <- data[strata_result$strata == 1, ]
stratum_2 <- data[strata_result$strata == 2, ]
# ... apply gc_ilr_model(), gc_sim_composition() separately
}

}
