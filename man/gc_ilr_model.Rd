% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geostat_model.R
\name{gc_ilr_model}
\alias{gc_ilr_model}
\title{Build Compositional Geostatistical Model}
\usage{
gc_ilr_model(
  ilr_params,
  variogram_model,
  data = NULL,
  model_type = "univariate"
)
}
\arguments{
\item{ilr_params}{A list from \code{gc_ilr_params()} containing mean, cov, names.}

\item{variogram_model}{A \code{vgm()} object defining the base variogram structure.}

\item{data}{Optional \code{sf} object with ILR columns for conditioning.
If provided, Conditional Simulation is performed.
If NULL (default), Unconditional Simulation is performed.}

\item{model_type}{Character string specifying the approach: \code{"univariate"}
(default) or \code{"lmc"}. Univariate is numerically stable and standard practice.
LMC includes cross-covariance terms between ILR dimensions.}
}
\value{
A \code{gstat} object representing the model.
}
\description{
Constructs a gstat model for the ILR-transformed variables using either
Independent Univariate Kriging or Linear Model of Coregionalization (LMC).
}
\details{
\strong{Independent Univariate Kriging} (\code{model_type = "univariate"}):
Models each ILR dimension separately without cross-covariance terms. This is:
\itemize{
\item Numerically stable (avoids positive-definite issues in LMC fitting)
\item Standard practice in compositional geostatistics
\item Robust across different datasets
\item Efficient for large problems
}

The ILR transformation already decorrelates the data significantly, so ignoring
spatial cross-correlation between ILR coordinates has minimal impact.

\strong{Linear Model of Coregionalization} (\code{model_type = "lmc"}):
Includes cross-covariance terms between all pairs of ILR dimensions. This is:
\itemize{
\item Theoretically more complete
\item More numerically complex
\item Useful when cross-correlation structure is important
}

For conditional simulation, the conditioning data must be passed to this function
(not to \code{predict()}). The model then automatically uses that data during prediction.
}
\examples{
\dontrun{
ilr_prm <- gc_ilr_params(compositions::acomp(data.frame(
  sand = c(50, 60, 45), silt = c(30, 25, 35), clay = c(20, 15, 20)
)))
vgm <- gstat::vgm(psill = 0.5, model = "Exp", range = 50, nugget = 0.1)
model <- gc_ilr_model(ilr_prm, vgm, model_type = "univariate")
}

}
\references{
Wackernagel, H. (2003). Multivariate Geostatistics: An Introduction with Applications (3rd ed.).
Springer-Verlag, Berlin.

ChilÃ¨s, J. P., & Delfiner, P. (2012). Geostatistics: Modeling Spatial Uncertainty (2nd ed.).
Wiley, Hoboken, NJ.

Tolosana-Delgado, R., Mueller, U., & van den Boogaart, K. G. (2012).
Geostatistics for Compositional Data: An Overview.
\emph{Mathematical Geosciences}, 44(4), 465-479. https://doi.org/10.1007/s11004-011-9363-4
}
