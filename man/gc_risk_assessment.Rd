% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/risk_assessment.R
\name{gc_risk_assessment}
\alias{gc_risk_assessment}
\title{Assess Risk with Loss Function Framework}
\usage{
gc_risk_assessment(
  simulations,
  threshold,
  loss_function,
  cost_params = list(a = 1, b = 1),
  operator = "<",
  na.rm = TRUE
)
}
\arguments{
\item{simulations}{A \code{terra::SpatRaster} stack with simulation realizations.}

\item{threshold}{Numeric threshold value for decision boundary
(e.g., minimum SOC for carbon credit, maximum contamination limit)}

\item{loss_function}{Character or function specifying loss computation.
\itemize{
\item \code{"linear"}: L(z) = a|z - t| (symmetric loss)
\item \code{"asymmetric"}: L(z) = a(t-z)⁺ + b(z-t)⁺ (asymmetric, different costs)
\item \code{"step"}: L(z) = a·I(z<t) + b·I(z>t) (binary cost)
\item Function: Custom function(z, threshold, cost_params)
}}

\item{cost_params}{List with cost parameters:
\itemize{
\item \code{a}: Cost of under-achievement (loss if Z < threshold)
\item \code{b}: Cost of over-achievement (loss if Z > threshold)
\item Default: \code{list(a = 1, b = 1)} for symmetric loss
\item Example: \code{list(a = 2, b = 1)} means under-estimate costs 2× over-estimate
}}

\item{operator}{Character: "<" (loss if under, default) or ">" (loss if over)}

\item{na.rm}{Logical. TRUE (default) = exclude NAs from expected value calculation}
}
\value{
List containing:
\itemize{
\item \code{expected_loss}: terra::SpatRaster with expected loss at each location
\item \code{decision}: terra::SpatRaster with binary decision (1=accept, 0=reject)
\item \code{cost_params}: Cost parameters used
\item \code{metadata}: List with threshold, operator, loss_function used
}
}
\description{
Compute expected loss maps under specified cost structure for decision-making.
Integrates asymmetric costs for false positives vs. false negatives.
}
\details{
\strong{Loss Function Framework:}

Expected loss at location s:

\deqn{EL(s|t) = \frac{1}{n} \sum_{k=1}^n L(Z(s)_k | t)}

Where L(z|t) is the loss function evaluated at each realization.

\strong{Decision Rule:}
Accept location if EL(threshold) < EL(threshold ± ε), otherwise reject.

\strong{Asymmetric Cost Example (Carbon Credits):}
\itemize{
\item a = 2.0: Cost of over-issuing undeserved credit (high financial risk)
\item b = 1.0: Cost of withholding valid credit (opportunity cost)
\item Decision threshold optimizes total risk
}
}
\examples{
\dontshow{if (Sys.getenv("R_GEOCODA_RUN_EXAMPLES") == "true") withAutoprint(\{ # examplesIf}
# Create synthetic data
set.seed(42)
carbon_sims <- terra::rast(ncol = 10, nrow = 10, nlyr = 50)
terra::values(carbon_sims) <- rnorm(5000, mean = 50, sd = 15)

# Carbon credit verification: Asymmetric costs
loss_result <- gc_risk_assessment(
  simulations = carbon_sims,
  threshold = 50,
  loss_function = "asymmetric",
  cost_params = list(
    a = 2.0,  # Cost of false positive (over-crediting)
    b = 1.0   # Cost of false negative (under-crediting)
  ),
  operator = "<"
)

terra::plot(loss_result$expected_loss, main = "Expected Loss")
terra::plot(loss_result$decision, main = "Credit Approval")
\dontshow{\}) # examplesIf}
}
