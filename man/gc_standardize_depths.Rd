% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vertical_discretization.R
\name{gc_standardize_depths}
\alias{gc_standardize_depths}
\title{Standardize Soil Profiles to Regular Depth Intervals}
\usage{
gc_standardize_depths(
  profiles,
  method = "spline",
  intervals = c(5, 15, 30, 60, 100),
  comp_cols = NULL,
  id_col = "mukey",
  verbose = FALSE
)
}
\arguments{
\item{profiles}{Data frame with soil profile data including:
\itemize{
\item hzdept_r: Horizon depth top (cm)
\item hzdepb_r: Horizon depth bottom (cm)
\item id_col column: Profile identifier
\item Component columns with compositional or numeric values
}}

\item{method}{Character specifying interpolation method:
\itemize{
\item "spline": Mass-preserving quadratic splines (requires aqp package)
\item "linear": Simple linear interpolation
Default: "spline"
}}

\item{intervals}{Numeric vector of standard depth slices (cm)
Default: c(0, 5, 15, 30, 60, 100) (GlobalSoilMap standard)
These are depth interval BOTTOMS: 0-5, 5-15, 15-30, 30-60, 60-100, 100+ cm}

\item{comp_cols}{Character vector of column names with values to standardize
(e.g., c("sandtotal", "silttotal", "claytotal") for texture)}

\item{id_col}{Character: Column name for profile identifier
(e.g., "mukey", "profile_id", "pedon_id")}

\item{verbose}{Logical: If TRUE, print progress messages}
}
\value{
Data frame with standardized depth intervals containing:
\itemize{
\item depth_top: Top of interval (cm)
\item depth_bot: Bottom of interval (cm)
\item id_col column: Original profile ID
\item Standardized values for each comp_cols at each interval
}

Attributes:
\itemize{
\item method: Interpolation method used
\item intervals: Depth intervals used
}
}
\description{
Convert irregular soil horizons to regular depth intervals using mass-preserving
splines (quadratic spline interpolation via the aqp package).
}
\details{
\strong{Mass-Preserving Splines (aqp::spc2mpspline):}
\itemize{
\item Ensures total mass (sum) is conserved: ∫ f(z) dz = measured_value
\item Quadratic interpolation for smooth depth functions
\item Ideal for soil properties where conservation of mass matters
\item Example: Total carbon (mg/cm²) in profile must equal sum of horizon carbon
}

\strong{GlobalSoilMap Standard Intervals:}
\itemize{
\item 0-5 cm (surface layer, influenced by land use, management)
\item 5-15 cm (topsoil, root zone)
\item 15-30 cm (subsoil, transitional)
\item 30-60 cm (subsurface, reduced activity)
\item 60-100 cm (deep subsoil)
\item 100+ cm (parent material, if available)
}

\strong{Alternatives to Specify Intervals:}
\itemize{
\item Custom intervals: c(10, 20, 30, 40, 50) for 10 cm slices
\item Two-depth system: c(30, 100) for 0-30, 30-100 cm
\item Single depth: c(100) for 0-100 cm aggregate
}

\strong{Mass Conservation Validation:}
Use \code{\link[=gc_validate_depth_standardization]{gc_validate_depth_standardization()}} to check that:
\itemize{
\item Original horizon values sum to standardized interval values
\item No mass was gained or lost in interpolation
}
}
\examples{
\dontrun{
# Load SSURGO component data
comp_data <- ssurgo_components  # Your SSURGO data frame

# Standardize to GlobalSoilMap depths
standardized <- gc_standardize_depths(
  profiles = comp_data,
  method = "spline",
  intervals = c(5, 15, 30, 60, 100),
  comp_cols = c("sandtotal", "silttotal", "claytotal"),
  id_col = "mukey",
  verbose = TRUE
)

# Check mass conservation
validation <- gc_validate_depth_standardization(comp_data, standardized)
print(validation)
}

}
