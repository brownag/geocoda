% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/input_validation.R
\name{gc_validate_input_data}
\alias{gc_validate_input_data}
\title{Validate Input Data for Geostatistical Simulation}
\usage{
gc_validate_input_data(
  data,
  component_names,
  x_coord = NULL,
  y_coord = NULL,
  target_sum = 100,
  sum_tolerance = 1,
  check_spatial = TRUE,
  check_outliers = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{data}{An \code{sf} object (with spatial geometry) or data frame with
compositional and coordinate columns}

\item{component_names}{Character vector, names of compositional components
(e.g., c("sand", "silt", "clay"))}

\item{x_coord}{Character, name of x-coordinate column (easting, longitude).
Required if data is not sf}

\item{y_coord}{Character, name of y-coordinate column (northing, latitude).
Required if data is not sf}

\item{target_sum}{Numeric, expected composition sum (default 100 for percentages)}

\item{sum_tolerance}{Numeric, allowable deviation from target_sum before flagging
(default 1, i.e., sums must be in \link{99, 101} for target_sum=100)}

\item{check_spatial}{Logical, validate spatial properties (duplicates, extent)
(default TRUE)}

\item{check_outliers}{Logical, detect statistical outliers using IQR method
(default TRUE)}

\item{verbose}{Logical, print detailed messages (default TRUE)}
}
\value{
A list with elements:
\itemize{
\item \code{valid}: Logical, whether data passes all checks
\item \code{issues}: Data frame listing all detected issues (severity, message, n_rows)
\item \code{summary}: Overall summary (n_observations, n_components, spatial_extent, etc)
\item \code{recommendations}: Character vector of actionable next steps
}
}
\description{
Perform comprehensive pre-flight checks on compositional and spatial data
before constrain definition or simulation. Detects missing values, invalid
compositions, outliers, and other common data quality issues.
}
\details{
The function performs these checks in order:

\strong{Structural Checks:}
\itemize{
\item Required columns present
\item Data types correct (numeric for components)
\item No completely empty rows
}

\strong{Compositional Checks:}
\itemize{
\item Sum constraints (each composition sums to target_sum Â± tolerance)
\item Range constraints (each component in \link{0, 100} or appropriate range)
\item Zero/negative handling
\item Compositional coherence (multivariate distributional shape)
}

\strong{Spatial Checks:}
\itemize{
\item Projected coordinates (non-geographic for meaningful distances)
\item Valid extent (not wrapped around poles or dateline)
\item Duplicate locations
\item Sufficient spatial spread
}

\strong{Statistical Checks:}
\itemize{
\item Univariate outliers (IQR method per component)
\item Multivariate outliers (Mahalanobis distance)
\item Extreme values vs domain knowledge
\item Sample size adequacy
}

Issues are categorized as:
\itemize{
\item "error": Will cause algorithm failure; must fix
\item "warning": May produce unreliable results; recommend fixing
\item "note": May be acceptable depending on use case; informational
}
}
\examples{
# Create sample compositional data with some issues
bad_data <- data.frame(
  x = c(1, 2, 3, 4, 5),
  y = c(1, 2, 3, 4, 5),
  sand = c(30, 40, 35, NA, 50),      # One NA
  silt = c(50, 45, 50, 55, 40),
  clay = c(20, 20, 15, 20, 5),       # Last row sums to 95, not 100
  texture = c("SL", "L", "L", "L", "SL")
)

validation <- gc_validate_input_data(
  bad_data,
  component_names = c("sand", "silt", "clay"),
  x_coord = "x",
  y_coord = "y"
)

print(validation$issues)
print(validation$recommendations)

}
