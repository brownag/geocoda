% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ensemble_validation.R
\name{gc_validate_realizations}
\alias{gc_validate_realizations}
\title{Validate Simulation Realizations Against Constraints}
\usage{
gc_validate_realizations(
  realizations,
  components,
  target_sum = 100,
  sum_tolerance = 1,
  constraints = NULL,
  realizations_per_component = NULL,
  verbose = FALSE
)
}
\arguments{
\item{realizations}{A \code{terra::SpatRaster} with simulation output
(multiple components and/or realizations)}

\item{components}{Character vector, names of compositional components
(e.g., c("sand", "silt", "clay"))}

\item{target_sum}{Numeric, target composition sum (default 100)}

\item{sum_tolerance}{Numeric, acceptable deviation from target_sum (default 1)
Composed values with |sum - target_sum| > tolerance are flagged}

\item{constraints}{List with per-component constraints (min, max).
If NULL (default), no boundary checking is performed.
Format: \code{constraints = list(SAND = list(min=0, max=100), ...)}}

\item{realizations_per_component}{Integer, number of realizations per component.
If NULL, inferred from layer names}

\item{verbose}{Logical, report processing steps (default FALSE)}
}
\value{
A list with elements:
\itemize{
\item \code{violations_map}: \code{terra::SpatRaster} with per-pixel violation count
(0 = all valid, higher = more violations)
\item \code{summary}: Data frame with per-component statistics:
\itemize{
\item \code{component}: Component name
\item \code{n_sum_violations}: Pixels where composition sum out of bounds
\item \code{n_boundary_violations}: Pixels where component value outside \link{min, max}
\item \code{pct_valid}: Percent of pixels with valid values
\item \code{mean}, \code{sd}: Mean and SD of component across all valid realizations
}
\item \code{constraint_ranges}: Echo of constraints used
\item \code{metadata}: Processing metadata
}
}
\description{
Assess realization quality by checking compositional sum constraints,
boundary violations, and spatial continuity. Returns per-pixel violation
counts and summary statistics.
}
\details{
This function is useful for diagnosing simulation artifacts:
\itemize{
\item High sum violations may indicate tight constraint bounds or compositional
arithmetic issues
\item Boundary violations suggest constraint specification issues
\item Spatial clustering of violations may indicate zone boundaries or
non-stationarity
}
}
\examples{
# Validate a realization raster
\dontrun{
validation <- gc_validate_realizations(
  realizations = my_sim_output,
  components = c("sand", "silt", "clay"),
  target_sum = 100,
  sum_tolerance = 1,
  constraints = list(
    SAND = list(min = 0, max = 100),
    SILT = list(min = 0, max = 100),
    CLAY = list(min = 0, max = 100)
  )
)

# Inspect violations
print(validation$summary)
plot(validation$violations_map)
}

}
